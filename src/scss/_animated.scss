.mobile-nav-overlay {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 2;
  cursor: pointer;
  background: $dark;
  opacity: 0.8;
  display: none;
}
.mobile-nav-overlay.js_visible {
  display: block;
}

.control-panel {
  top: 0;
  z-index: 3;
  width: $cp_width--mobile;
  height: 100vh;
  will-change: transform;
  transform: translate3d(0,0,0);
  overflow-y: hidden;
  position: absolute;
  @media (max-height: 511px) {
    overflow-y: scroll;
    will-change: scroll-position;
  }
  @media (max-width: 991px) {
    overflow-y: scroll;
    will-change: scroll-position;
  }




  // tweak for really small mobile
  @include mobile-only {
    max-width: 100vw;
    right: -100vw;
  }
  @include desktop-only {
    left:-$cp_width--large;
    width: $cp_width--large;
    overflow-x: hidden;
  }
  @include xl-only {
    width: $cp_width--xl;
  }
}

.control-panel.js_visible {

  transition: transform 300ms ease-in-out;
  transform-style: preserve-3d;

  @media (max-width: $mobile_max) {
    transform: translate3d(-100vw, 0, 0);

  }
  @media (max-width: $cp_width--bp) {
    width: 100vw;
    transform: translate3d(-100vw, 0, 0);
  }
  @media (min-width: $desktop_min) {
    transform: translate3d($cp_width--large, 0, 0);
  }
}

@media (min-width: $desktop_min) {
  // .site-title,
  .site-header,
  .site-footer {
    transform: translate3d(0,0,0);
    will-change: transform;
  }
  // .site-title.is_animated,
  .site-header.is_animated,
  .site-footer.is_animated {
    transform: translate3d($cp_width--large,0,0);
    transition: transform 300ms ease-in-out;
  }

  .toggle-control-panel {
    will-change: background;
    @include desktop-only {
      padding-bottom: 1rem;
    }

    .icon--from_right,
    .text--hide {
      display: none;
    }
  }

  .toggle-control-panel:hover {
    @include desktop-only {
      background: rgba(100,100,100,0.3);
      transition: background 300ms ease-in-out;
    }
  }

  .toggle-control-panel.is_animated {
    transition: background 300ms ease-in-out;

    text-align: left;
    padding-left: 5rem;
    padding-right: 0;
    background: rgba(100,100,100,0.3);

    border-radius: 2px;

    .text--hide {
      display: inline;
    }
    .icon--from_right {
      display: block;
      left: 1rem;
    }
    .text--show,
    .icon--from_left {
      display: none;
    }
  }
}
@include xl-only {
  // .site-title.is_animated,
  .site-header.is_animated,
  .site-footer.is_animated {
    transform: translate3d($cp_width--xl,0,0);
    transition: transform 300ms ease-in-out;
  }
}



.secondary-panel.select-types.js_visible {
  display: block;
}

.secondary-panel.select-countries.js_visible {
  display: block;
}

.secondary-panel.select-view.js_visible {
  display: block;
}

.details-panel {
  position: absolute;
  top: 0;
  z-index: 4;
  transform: translate3d(0,0,0);
  will-change: transform;
  height: 100vh;
  overflow-y: scroll;;
  @include mobile-only {
    width: $cp_width--mobile;
    right: -$cp_width--mobile;
  }
  @include desktop-only {
    width: $cp_width--large;
    right: -$cp_width--large;
  }
  @include xl-only {
    width: $cp_width--xl;
    right: -$cp_width--xl;
  }

  .button--close {
    display: none;
  }

  &.is_animated {
    transition: transform 300ms ease-in-out;

    @include mobile-only {
      transform: translate3d(-$cp_width--mobile,0,0);
    }
    @include desktop-only {
      transform: translate3d(-$cp_width--large,0,0);
    }
    @include xl-only {
      transform: translate3d(-$cp_width--xl,0,0);
    }

    .details-panel__scroll {
      transform: translate3d(0,0,0);
    }


    .button--close {
      display: block;
      transition: display 300ms ease-in-out;
      transition-delay: 300ms;
    }
  }
}





// exceptions to the no-id selector convention
#toggle_export {
    @include desktop-only {
      transform: translate3d(0,0,0);
      will-change: transform;
    }
}
#toggle_export.is_animated {
  transition: transform 300ms ease-in-out;
  @include desktop-only {
    transform: translate3d(-$cp_width--large,0,0);
  }
  @include xl-only {
    transform: translate3d(-$cp_width--xl,0,0);
  }
}




// also note:  reordering these list items will break layout on mobile
#finance_list_item,
#visits_list_item {
  @include mobile-only {
      will-change: height;
  }
}

#finance_list_item.js_toggled {
  @include mobile-only {
    height: calcRem($f1,16.75);
    transition: height 300ms ease-in-out;
  }
}
#visits_list_item.js_toggled {
  @include mobile-only {
    height: (calcRem($f1,10.75));
    transition: height 300ms ease-in-out;
  }
}

#finance_subtypes,
#visits_subtypes {
  visibility: hidden;
  opacity: 0;
  position: absolute;

  @include mobile-only {

    z-index: 2;
    padding-left: calcVW(2,$grid);
    padding-right: calcVW(2,$grid);
    padding-top: 0;
    padding-bottom: 0;
    width: 100%;
    border: 2px solid;

    .legend--subtypes {
      font-size: $font_size_1;
      margin-left: calcVW(6,$grid);
      padding-bottom: calcRem(1,$f1);
    }
    .label--sub-option {
      padding-left: calcVW(10, $grid);
    }
  }
  @include desktop-only {
    left: calcVW(10,$cols);
  }
}

#finance_subtypes.js_toggled,
#visits_subtypes.js_toggled {
  visibility: visible;
  opacity: 1;
  transition: visibility 0s, opacity 0.5s ease-in-out;
  @include mobile-only {
  }
  @include desktop-only {
    margin-left: calcVW(0.5,$cols);
    padding-top: 0;
    flex-basis: calcVW(4,$cols);
  }
}
#finance_subtypes.js_toggled {
  @include mobile-only {
    top: calcRem($f1,11);
  }
  @include desktop-only {
    top: calcRem($f1,5.5);
  }
}
#visits_subtypes.js_toggled {
  @include mobile-only {
    top: calcRem($f1,20);
  }
  @include desktop-only {
    top: calcRem($f1,14.5);
  }
}

#export_data_options {
  visibility: hidden;
  opacity: 0;
  height: 0;
  will-change: height;
}
#export_data_options.js_toggled {
  visibility: visible;
  opacity: 1;
  transition: visibility 0s, opacity 0.5s ease-in-out;
  height: auto;
}


// themes
@include mobile-only {
  .theme--dark {
    #finance_list_item.js_toggled
    #visits_list_item.js_toggled {
      @include dark-background;
    }
    #finance_subtypes,
    #visits_subtypes {
      @include darker-background;
      @include white-border;

      .legend--subtypes {
          @include light-red-text;
      }
    }

  }

  .theme--light {
    #finance_list_item.js_toggled,
    #visits_list_item.js_toggled {
      @include light-background;
    }
    #finance_subtypes,
    #visits_subtypes {
      @include lighter-background;
      @include gray-border;

      .legend--subtypes {
        @include red-text;
      }
    }
  }
}
// end themes
